#include <Arduino.h>            // Подключаем базовую библиотеку Arduino с определениями основных функций и типов
#include <WiFi.h>               // Modified: требуется для запуска точки доступа ESP32

#include "TempRegulator.h"      // Подключаем заголовок с классом регулятора температуры и всеми связанными объявленими
#include "WebInterface.h"       // Modified: подключаем веб-интерфейс с WebSocket

void setup() {                   // Функция setup() запускается один раз при старте микроконтроллера
  Serial.begin(115200);          // Инициализируем последовательный порт для отладки на скорости 115200 бод
  WiFi.mode(WIFI_AP);            // Modified: переводим Wi-Fi модуль в режим точки доступа
  WiFi.softAP("TR-MUF-1", "12345678");  // Modified: создаём точку доступа с заданным именем и паролем
  regulator.begin();             // Выполняем начальную настройку регулятора: дисплея, датчиков, памяти и т.д.
  WebInterface::instance().begin(&regulator);  // Modified: запускаем HTTP и WebSocket серверы
}

void loop() {                    // Главный цикл программы, выполняется непрерывно после setup()
  regulator.update();            // Обновляем состояние регулятора: обработка интерфейса, измерений и управляющих сигналов
  WebInterface::instance().loop();  // Modified: обслуживаем веб-интерфейс и отправку телеметрии
  delay(1);                      // Делаем короткую паузу (1 мс), чтобы разгрузить процессор и дать LVGL обработать события
}

